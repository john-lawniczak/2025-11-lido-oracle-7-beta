{
  "meta": {
    "schema_version": "2.0.0"
  },
  "true_positives": [
    {
      "id": "LIDO-TP-002",
      "title": "Validator balance underreporting enables fee overcharge via fee exemption",
      "finding_id": "71172256-7836-400b-b87c-58e477dafe90",
      "severity_claimed_by_scan": "MEDIUM",
      "severity_final": "MEDIUM",
      "bug_category": "Security",
      "scope_status": "OUT_OF_SCOPE",
      "date_added": "2025-11-19",
      "exploit_summary": "A caller with NODE_OPERATOR_FEE_EXEMPT_ROLE can intentionally underreport _allSourceValidatorBalancesWei when generating fee exemption calldata, causing part of principal to be treated as rewards and incur operator fees.",
      "impact_description": "Vault suffers value extraction via excess node operator fees charged on underreported principal during validator consolidation.",
      "code_path": "Contracts/contracts/0.8.25/vaults/ValidatorConsolidationRequests.sol",
      "code_snippet": "if (_allSourceValidatorBalancesWei != 0 && \\n    _allSourceValidatorBalancesWei < consolidationRequestsCount * MINIMUM_VALIDATOR_BALANCE) {\\n    revert InvalidAllSourceValidatorBalancesWei();\\n}\\n\\nif (_allSourceValidatorBalancesWei > 0) {\\n    feeExemptionEncodedCall = abi.encodeWithSelector(\\n        NodeOperatorFee.addFeeExemption.selector,\\n        _allSourceValidatorBalancesWei\\n    );\\n}",
      "line_numbers": "lines 118–134",
      "commit_hash": "d6c09a16736b2c132343a4e349c8f27179c73e6e",
      "chain": "EVM",
      "language": "Solidity",
      "ecosystem": "Immunefi",
      "contest": "Lido Accounting Oracle v7 Competition",
      "project_profile_tags": ["oracle_networks", "staking_liquid_staking"],
      "competition_result": "OUT_OF_SCOPE - privileged-role required (per AuditBrief)",
      "scope_rationale": "Contract is in-scope, but exploit requires NODE_OPERATOR_FEE_EXEMPT_ROLE. AuditBrief excludes attacks requiring privileged addresses; likely rejected unless an unprivileged path exists (none evident).",
      "custom_rule_matched": false,
      "auditor": "JohnLaw",
      "llm_model": "GPT-5"
    },
    {
      "id": "LIDO-TP-003",
      "title": "Vault owner can front-run forced validator exits by temporary funding",
      "finding_id": "8b2d2453-694d-476e-ba05-29eb901ab37d",
      "severity_claimed_by_scan": "MEDIUM",
      "severity_final": "MEDIUM",
      "bug_category": "Security",
      "scope_status": "OUT_OF_SCOPE",
      "date_added": "2025-11-19",
      "exploit_summary": "Vault owner can send a small fund() top-up to eliminate obligations shortfall right before inclusion, causing forceValidatorExit to revert and blocking enforcement.",
      "impact_description": "Indefinite griefing/denial of protocol-enforced rebalancing with minimal capital, potentially worsening systemic risk.",
      "code_path": "Contracts/contracts/0.8.25/vaults/VaultHub.sol",
      "code_snippet": "function forceValidatorExit(\\n    address _vault,\\n    bytes calldata _pubkeys,\\n    address _refundRecipient\\n) external payable onlyRole(VALIDATOR_EXIT_ROLE) {\\n    VaultConnection storage connection = _checkConnection(_vault);\\n    VaultRecord storage record = _vaultRecord(_vault);\\n    _requireFreshReport(_vault, record);\\n\\n    uint256 obligationsShortfallAmount = _obligationsShortfallValue(_vault, connection, record);\\n    if (obligationsShortfallAmount == 0) revert ForcedValidatorExitNotAllowed();\\n}",
      "line_numbers": "lines 932–944",
      "commit_hash": "d6c09a16736b2c132343a4e349c8f27179c73e6e",
      "chain": "EVM",
      "language": "Solidity",
      "ecosystem": "Immunefi",
      "contest": "Lido Accounting Oracle v7 Competition",
      "project_profile_tags": ["oracle_networks", "staking_liquid_staking"],
      "competition_result": "OUT_OF_SCOPE - privileged actor required (per AuditBrief)",
      "scope_rationale": "Contract is in-scope, but grief relies on vault owner actions. AuditBrief excludes attacks requiring privileged addresses; likely rejected unless an unprivileged path exists.",
      "custom_rule_matched": false,
      "auditor": "JohnLaw",
      "llm_model": "GPT-5"
    }
  ]
}

